<!DOCTYPE html>
<meta charset="UTF-8">
<html>
<head>

<style>
html,body,#map{width:100%;height:100%;padding:0;margin:0;}
</style>

<title>Geoportal Wysp Smoczych</title>
<link rel="icon" type="image/ico" href="krzyz_asparii.ico"/>

</head>

<body>
<div id="map"></div>

<link rel="stylesheet" href="leaflet/leaflet.css">
<script src="leaflet/leaflet.js"></script>

<script src="Miasta_0_5.js"></script>
<script src="Wyspy_0_3.js"></script>

<script src="dist/L.Icon.Mapkey.js"></script>
<link rel="stylesheet" href="dist/MapkeyIcons.css" />
<script>

var full_map = L.map('map', {
	maxZoom:10,
	minZoom:6.5,
    center: [-39, -67],
    zoom: 6.5
});

var tlo=L.tileLayer('https://mapwarper.net/maps/tile/88671/{z}/{x}/{y}.png?{foo}', {foo: 'bar', attribution: ' <a href="https://mapwarper.net">Map Warper</a>'})
tlo.addTo(full_map)

var wyspy_layer =L.geoJSON(wyspy, {
	style: wyspy_STL_off,
	onEachFeature: wyspy_oEF
}).addTo(full_map);

var miasta_layer = L.geoJSON(miasta, {
	onEachFeature: miasta_oEF,
	pointToLayer: miasta_PToL,
}).addTo(full_map);

function wyspy_STL_off(feature) {
	return {
		color: "black",
		fillColor: "green",
		fillOpacity: 0.5,
		weight: 2
	};
}

function wyspy_STL_on(feature) {
	return {
		color: "red",
		fillColor: "orange",
		fillOpacity: 0.7,
		weight: 2
	};
}

function wyspy_oEF (feature,layer) {
	var props = feature.properties;
	var center = layer.getBounds().getCenter();
	var tt = L.tooltip(center, {content: props.Nazwa, direction: 'center'})
	layer.on('mouseover', function () {
		layer.setStyle(wyspy_STL_on(feature));
		tt.openOn(full_map);
	});
	layer.on('mouseout', function () {
		layer.setStyle(wyspy_STL_off(feature));
		full_map.closePopup(tt);
	});
}

function miasta_PToL(feature,latlng) {
	var props = feature.properties;
	var mki = L.icon.mapkey({icon:props.ikona,color:'white',background:'red',size:30});
	return L.marker(latlng,{icon:mki});
}

function miasta_oEF (feature,layer) {
	var props = feature.properties;
	layer.bindTooltip(props.nazwa+'<br>'+props.opis);
}

L.control.scale().addTo(full_map);
var baseLayers = {
    "TÅ‚o": tlo
};

var overlays = {
    "Miasta": miasta_layer,
	"Wyspy": wyspy_layer
};

L.control.layers(baseLayers, overlays).addTo(full_map);

full_map.attributionControl.setPrefix(
	'<a href="http://leafletjs.com">ðŸ‡ºðŸ‡¦ Leaflet</a> | <a href="https://github.com/mapshakers/leaflet-mapkey-icon/tree/master">mapkeyicons</a>',
	);
</script>
</body>

</html>